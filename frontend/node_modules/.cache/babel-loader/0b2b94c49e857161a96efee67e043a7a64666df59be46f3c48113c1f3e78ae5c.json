{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\trial\\\\frontend\\\\src\\\\pages\\\\ProfilePage.js\",\n  _s = $RefreshSig$();\n// frontend/src/pages/ProfilePage.js\nimport React, { useEffect, useState } from \"react\";\nimport useAuth from \"../hooks/useAuth\";\nimport authService from \"../api/authService\"; // If you want to re-fetch /me\nimport LoadingSpinner from \"../components/LoadingSpinner\";\nimport { formatDate } from \"../utils/formatDate\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProfilePage = () => {\n  _s();\n  const {\n    user: contextUser,\n    token,\n    loading: authLoading,\n    initializeAuth\n  } = useAuth();\n  const [userData, setUserData] = useState(contextUser);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  useEffect(() => {\n    // Use user from context if already loaded, otherwise fetch\n    if (contextUser && !authLoading) {\n      setUserData(contextUser);\n      setLoading(false);\n    } else if (!authLoading && token) {\n      // If context user not loaded but token exists, try fetching\n      const fetchMe = async () => {\n        try {\n          const freshUser = await authService.getCurrentUser();\n          if (freshUser) {\n            setUserData(freshUser);\n            // Optionally re-trigger context initialization if it didn't pick up this user\n            // initializeAuth(); // Be careful with infinite loops if not managed correctly\n          } else {\n            setError(\"Could not fetch user details.\");\n          }\n        } catch (err) {\n          var _err$response, _err$response$data;\n          setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Failed to fetch profile.\");\n        } finally {\n          setLoading(false);\n        }\n      };\n      fetchMe();\n    } else if (!authLoading && !token) {\n      setError(\"You are not logged in.\");\n      setLoading(false);\n    }\n  }, [contextUser, token, authLoading, initializeAuth]);\n  if (loading || authLoading) {\n    return /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 12\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 12\n    }, this);\n  }\n  if (!userData) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No user data available. Please log in.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"My Profile\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"publication-detail\",\n      style: {\n        maxWidth: \"600px\",\n        margin: \"20px auto\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Username:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), \" \", userData.username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Email:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), \" \", userData.email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Role:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), \" \", userData.role]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Joined:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), \" \", formatDate(userData.createdAt)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n};\n_s(ProfilePage, \"fiXwAwGuobi37LI0uny7oq/79WY=\", false, function () {\n  return [useAuth];\n});\n_c = ProfilePage;\nexport default ProfilePage;\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["React","useEffect","useState","useAuth","authService","LoadingSpinner","formatDate","jsxDEV","_jsxDEV","ProfilePage","_s","user","contextUser","token","loading","authLoading","initializeAuth","userData","setUserData","setLoading","error","setError","fetchMe","freshUser","getCurrentUser","err","_err$response","_err$response$data","response","data","message","fileName","_jsxFileName","lineNumber","columnNumber","className","children","style","maxWidth","margin","username","email","role","createdAt","_c","$RefreshReg$"],"sources":["C:/Users/DELL/Desktop/trial/frontend/src/pages/ProfilePage.js"],"sourcesContent":["// frontend/src/pages/ProfilePage.js\r\nimport React, { useEffect, useState } from \"react\";\r\nimport useAuth from \"../hooks/useAuth\";\r\nimport authService from \"../api/authService\"; // If you want to re-fetch /me\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport { formatDate } from \"../utils/formatDate\";\r\n\r\nconst ProfilePage = () => {\r\n  const {\r\n    user: contextUser,\r\n    token,\r\n    loading: authLoading,\r\n    initializeAuth,\r\n  } = useAuth();\r\n  const [userData, setUserData] = useState(contextUser);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    // Use user from context if already loaded, otherwise fetch\r\n    if (contextUser && !authLoading) {\r\n      setUserData(contextUser);\r\n      setLoading(false);\r\n    } else if (!authLoading && token) {\r\n      // If context user not loaded but token exists, try fetching\r\n      const fetchMe = async () => {\r\n        try {\r\n          const freshUser = await authService.getCurrentUser();\r\n          if (freshUser) {\r\n            setUserData(freshUser);\r\n            // Optionally re-trigger context initialization if it didn't pick up this user\r\n            // initializeAuth(); // Be careful with infinite loops if not managed correctly\r\n          } else {\r\n            setError(\"Could not fetch user details.\");\r\n          }\r\n        } catch (err) {\r\n          setError(err.response?.data?.message || \"Failed to fetch profile.\");\r\n        } finally {\r\n          setLoading(false);\r\n        }\r\n      };\r\n      fetchMe();\r\n    } else if (!authLoading && !token) {\r\n      setError(\"You are not logged in.\");\r\n      setLoading(false);\r\n    }\r\n  }, [contextUser, token, authLoading, initializeAuth]);\r\n\r\n  if (loading || authLoading) {\r\n    return <LoadingSpinner />;\r\n  }\r\n\r\n  if (error) {\r\n    return <p className=\"error-message\">{error}</p>;\r\n  }\r\n\r\n  if (!userData) {\r\n    return <p>No user data available. Please log in.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <h1>My Profile</h1>\r\n      <div\r\n        className=\"publication-detail\"\r\n        style={{ maxWidth: \"600px\", margin: \"20px auto\" }}\r\n      >\r\n        <p>\r\n          <strong>Username:</strong> {userData.username}\r\n        </p>\r\n        <p>\r\n          <strong>Email:</strong> {userData.email}\r\n        </p>\r\n        <p>\r\n          <strong>Role:</strong> {userData.role}\r\n        </p>\r\n        <p>\r\n          <strong>Joined:</strong> {formatDate(userData.createdAt)}\r\n        </p>\r\n        {/* You can add more details if available, e.g., last updated */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}